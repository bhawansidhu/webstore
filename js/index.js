const dress1 = {
  name: `Blue Shirt`,
  imageUrl: `img/blue shirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  discount: 20,
  productCode: 2501,
  sizes: [6, 7, 8, 9],
  brand: `Zara`,
  category: `Formal`,
  price: `90`,
  rating: 4.3,

};

const dress2 = {
  name: `Red Shirt`,
  imageUrl: `img/red shirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  discount: 20,
  productCode: 2502,
  sizes: [6, 7, 8, 9],
  brand: `Zara`,
  category: `Formal`,
  price: `90`,
  rating: 4.4,

};

const dress3 = {
  name: `white Shirt`,
  imageUrl: `img/white shirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: false,
  productCode: 2503,
  sizes: [6, 7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `causal`,
  price: `90`,
  rating: 4.3,

};

const dress4 = {
  name: `Black Shirt`,
  imageUrl: `img/black shirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: false,
  productCode: 2504,
  sizes: [7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `Formal`,
  price: `100`,
  rating: 4.4,

};


const dress5 = {
  name: `black jeans`,
  imageUrl: `img/black jeans.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: true,
  productCode: 2505,
  sizes: [6, 7, 9],
  discount: 10,
  brand: `Zara`,
  category: `causal`,
  price: `150`,
  rating: 4.5,

};

const dress6 = {
  name: `blue jeans`,
  imageUrl: `img/blue jeans.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: false,
  productCode: 2506,
  sizes: [6, 7, 9],
  discount: 10,
  brand: `Zara`,
  category: `causal`,
  price: `130`,
  rating: 4.3,

};

const dress7 = {
  name: `skinny jeans`,
  imageUrl: `img/skinny jeans.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: true,
  productCode: 2507,
  sizes: [6, 7, 8,],
  discount: 10,
  brand: `Zara`,
  category: `causal`,
  price: `120`,
  rating: 4.5,

};

const dress8 = {
  name: `white jeans`,
  imageUrl: `img/white jeans.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: false,
  productCode: 2508,
  sizes: [7, 8, 9],
  discount: 10,
  brand: `Zara`,
  category: `formal`,
  price: `120`,
  rating: 4.3,

};

const dress9 = {
  name: `Blue Skirt`,
  imageUrl: `img/blueskirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2517,
  sizes: [6, 7, 8, 9],
  discount: 10,
  brand: `Zara`,
  category: `Formal`,
  price: `350`,
  rating: 4.4,

};

const dress10 = {
  name: `red Skirt`,
  imageUrl: `img/red skirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: false,
  productCode: 2518,
  sizes: [6, 7, 8, 9],
  discount: 10,
  brand: `Zara`,
  category: `causal`,
  price: `355`,
  rating: 4.5,

};

const dress11 = {
  name: `black Skirt`,
  imageUrl: `img/black skirt.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2519,
  sizes: [6, 7, 9],
  discount: 10,
  brand: `Zara`,
  category: `Formal`,
  price: `420`,
  rating: 4.3,

};

const dress12 = {
  name: `white Skirt`,
  imageUrl: `img/white skirt.jpeg`,
  colors: [`white`, `blue`, `red`],
  productOnSale: false,
  productCode: 2520,
  sizes: [6, 7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `Formal`,
  price: `348`,
  rating: 4.4,

};



const dress= [ dress1, dress2,  dress3, dress4, dress5, dress6, dress7, dress8, dress9, dress10, dress11, dress12];




const footWear1 = {
  name: `Ankle shoes`,
  imageUrl: `img/ankle shoes.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2509,
  sizes: [6, 7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `causal`,
  price: `200`,
  rating: 4.3,

};

const footWear2 = {
  name: `brown shoes`,
  imageUrl: `img/brown shoes.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2510,
  sizes: [6, 7, 8,],
  discount: 20,
  brand: `Zara`,
  category: `Formal`,
  price: `190`,
  rating: 4.4,

};

const footWear3 = {
  name: `white shoes`,
  imageUrl: `img/white shoes.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: false,
  productCode: 2511,
  sizes: [6, 7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `causal`,
  price: `290`,
  rating: 4.3,

};

const footWear4 = {
  name: `snow shoes`,
  imageUrl: `img/snow shoes.jpg`,
  colors: [`white`, `blue`, `balck`],
  productOnSale: true,
  productCode: 2512,
  sizes: [6, 7, 8, 9],
  discount: 20,
  brand: `Zara`,
  category: `causal`,
  price: `180`,
  rating: 4.4,

};


const footWear5 = {
  name: `Black heels`,
  imageUrl: `img/black heels.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2513,
  sizes: [6, 7, 8, 9],
  discount: 15,
  brand: `Zara`,
  category: `Formal`,
  price: `390`,
  rating: 4.4,

};

const footWear6 = {
  name: `red heels`,
  imageUrl: `img/red heels.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: false,
  productCode: 2514,
  sizes: [6, 7, 8, 9],
  discount: 15,
  brand: `Zara`,
  category: `Formal`,
  price: `160`,
  rating: 4.5,

};

const footWear7 = {
  name: `white heels`,
  imageUrl: `img/white heel.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2515,
  sizes: [6, 7, 8, 9],
  discount: 15,
  brand: `Zara`,
  category: `causal`,
  price: `190`,
  rating: 4.4,

};

const footWear8 = {
  name: `Blue heels`,
  imageUrl: `img/blue heels.jpg`,
  colors: [`white`, `blue`, `balck`, `red`],
  productOnSale: true,
  productCode: 2516,
  sizes: [6, 7, 8, 9],
  discount: 15,
  brand: `Zara`,
  category: `Formal`,
  price: `150`,
  rating: 4.3,

};

const footWear = [footWear1, footWear2, footWear3, footWear4, footWear5, footWear6, footWear7, footWear8];




const shoesData = dress.concat(footWear);


const shoppingCart = [
  {ID: 101, qty: 1}
];

const wishlist=[
  {
    ID:100, qty:1}
  ];

//functions




function getShoesAsHtml(shoesData) {
  let cartBtn=``;
  let heartButton=`<button type="button" class="heartBtn" data-code="${shoesData.productCode}" id="heartBtn"><span class="material-icons">favorite</span></button>`;
  let onsale='';
  let outOfStock=``;
  if(shoesData.onSale==true && shoesData.stock > 0){
    onsale=`<small class="onsale_banner">On Sale!</small>`;
    cartBtn=`<button type="button" class="productCardButton"  data-code="${shoesData.productCode}" id="addtocart"><span class="material-icons">add_shopping_cart</span> Add to Cart</button> `;
  
  }
  else{
    onsale=`<small class="outofstock">Out of stock</small>`
  }

  return `
    <section class="productsCard"> 
    <img class="productCardImg" src="${shoesData.imageUrl}" alt="${shoesData.name}" style="width:100%;height:130px;">
    ${heartButton}
    ${onsale}
    <h1 class="ProductCardName"><strong>${shoesData.name}</strong></h1>
        <ul class="productCardList">
          <li class="productCardListItem"><h3>${shoesData.category}</h3></li>
          <li class="productCardListItem"><h3>Price: $${shoesData.price}</h3></li>
          <li class="productCardListItem"><p>Average rating: ${shoesData.rating}<p></li>
          <li>${shoesData.discount}</li>
          <section class="onhoverShow">testing mee</section>
        </ul>
        ${cartBtn}
        </section>`;
}

document.getElementById(`app`).innerHTML = shoesData
  .map(getShoesAsHtml)
  .join("\n");

  //search functionality
function LoadProductsByName(e){
  e.preventDefault();
  const search=document.getElementById('find').value;
  const lowerCase=search.trim().toLowerCase();
  const searchResultsArray=shoesData.filter(p=> p.name.toLowerCase().includes(lowerCase));
  renderProducts(searchResultsArray);
}

//addto cart function
function handleClicksofBtns(){
  if (event.target.matches('button.productCardButton')) {
    const code = parseInt(event.target.dataset.code);
    addItemToCart(code);
  }

  if (event.target.closest('button').matches('button.heartBtn')) {
    const code = parseInt(event.target.closest('button').dataset.code);
      addToWishlist(code);
  }
  else{
    if(!event.target.matches('button.heartBtn') && !event.target.matches('button.productCardButton')){
      return;
    }
  
  
}}



const addToWishlist = pID => {
 

  const cartItem = wishlist.find(item => item.ID == pID);

  if (cartItem) {  // if a cartItem was found
    cartItem.qty++;
    alert("Item has been already added to wishlist ");
  } else {
    wishlist.push({ID: pID, qty: 1});
    alert("New wishlist item has been added wishlist");
  }
}

//add to wishlist

const addItemToCart = pID => {
  // [ {courseid: 101, qty: 1} ]

  const cartItem = shoppingCart.find(item => item.ID == pID);

  if (cartItem) {  // if a cartItem was found
    cartItem.qty++;
    alert("Another item has been added to your cart");
  } else {
    shoppingCart.push({ID: pID, qty: 1});
    alert("A new item has been added to your cart");
  }
}



function LoadFilterMenu(){
  const x = document.getElementById("filtermenu");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "none";
  }
}
//filter functions

function LoadProductsByPriceFilter(){
 const price=document.getElementById('PriceFilter').value;
 const searchResultsArray=shoesData.filter(p=> p.price <= price);
 renderProducts(searchResultsArray);
}



function LoadProductsByFilters(){
  //heirarchy category>rating >brand> colour > size >  discount 
  let category;
  let rating;
  let brand;
  let discount;
  arrayByCategory=[];
  arrayByRatings=[];
  arrayByBrand=[];
  arrayByDiscount=[];

  if(document.querySelector('input[name="category"]:checked')!=null){
    category=document.querySelector('input[name="category"]:checked').value;
    alert(category);
    arrayByCategory=shoesData.filter(p=>p.category==category);
  }
  else {
    arrayByCategory=shoesData;
  }
  if(document.querySelector('input[name="rating"]:checked') != null){
    rating=document.querySelector('input[name="rating"]:checked').value;
    arrayByRatings=arrayByCategory.filter(p=>p.rating >= rating);
  }
  else{
    arrayByRatings=arrayByCategory;
  }

  if(document.querySelector('input[name="brand"]:checked')!=null){
    brand=document.querySelector('input[name="brand"]:checked').value;
    arrayByBrand=arrayByRatings.filter(p=>p.brand.toLowerCase() == brand.toLowerCase());
  }
  else{
    arrayByBrand=arrayByRatings;
  }

  if(document.querySelector('input[name="discount"]:checked')!=null){
    discount=document.querySelector('input[name="discount"]:checked').value;
    arrayByDiscount=arrayByBrand.filter(p=>p.discount == discount);
  }
  else{
    arrayByDiscount=arrayByBrand;
  }

  renderProducts(arrayByDiscount);
  

}


//sorting functions
function LoadProductsPriceHighTolow() {
  //alert("in high to low");
  const PriceHighToLowArray = shoesData
    .slice(0)
    .sort((a, b) => (a.price < b.price ? 1 : -1));
  renderProducts(PriceHighToLowArray);
}

function LoadProductsPriceLowToHigh() {
  //alert("in low to high");
  const PriceLowToHighArray = shoesData
    .slice(0)
    .sort((a, b) => (a.price > b.price ? 1 : -1));
  renderProducts(PriceLowToHighArray);
}

function LoadProductsByAvailability() {
  //alert("in availability function");
  const availabilityArray = shoesData
    .slice(0)
    .sort((a, b) => (a.stock < b.stock ? 1 : -1));
  renderProducts(availabilityArray);
}

function LoadProductsByRatings() {
  //alert("in rating function");
  const ratingArray = shoesData
    .slice(0)
    .sort((a, b) => (a.rating < b.rating ? 1 : -1));
  renderProducts(ratingArray);
}

function LoadProductsOnSale(){
  //alert("in onsale function");
  const onSaleArray= shoesData.slice(0).filter(p => p.onSale == true).filter(p=>p.stock>0);
  renderProducts(onSaleArray);
}




/*const addToClickToHeartBtn = element => {
  const addToWishlist = () => {
    if (element.style.color != 'red') {
      element.style.color = 'red';
    } else {
      element.style.color = 'rgb(63, 46, 46)'
    };
  }

  element.addEventListener('click', addToWishlist)
}

const addToClickToCartBtn = element => {
  const addTOCart = () => {
    if (element.style.backgroundColor != `red` && element.innerHTML != `Remove from Cart`) {
      element.style.backgroundColor = `red`;
      element.innerHTML = `Remove from Cart`;
    } else {
      element.style.backgroundColor = `rgba(0, 0, 0, .87)`;
      element.innerHTML = `Add to Cart`;
    }

  }
  element.addEventListener('click', addTOCart)
}*/


function renderProducts(arr) {
  document.getElementById(`app`).innerHTML = arr.map(getShoesAsHtml).join("\n");
  let res = 'Products';
  if (arr.length == 1) {
    res = 'Product'
    document.getElementById('numResults').innerHTML = `(${arr.length} ${res})`;
  }
 if(arr.length==0){
  res = 'Products'
    document.getElementById('numResults').innerHTML = `(${arr.length} ${res})`;
    document.getElementById(`app`).innerHTML=`<h1>O RESULTS found!</h1>`
 }
 
}




//execution
window.addEventListener('load', () => {

//const heartBtn = document.querySelectorAll(`.heartBtn`);
//heartBtn.forEach(addToClickToHeartBtn);
//const AddtoCartBtn = document.querySelectorAll(`.productCardButton`);
//AddtoCartBtn.forEach(addToClickToCartBtn);
document.getElementById(`find`).addEventListener("change",LoadProductsByName);
document.getElementById(`PriceHighToLow`).addEventListener("click", LoadProductsPriceHighTolow);
document.getElementById(`PriceLowToHigh`).addEventListener("click", LoadProductsPriceLowToHigh);
document.getElementById(`availability`).addEventListener("click", LoadProductsByAvailability);
document.getElementById(`topRated`).addEventListener("click", LoadProductsByRatings);
document.getElementById(`onSale`).addEventListener("click", LoadProductsOnSale);
document.getElementById(`filter`).addEventListener("click", LoadFilterMenu);
document.getElementById(`PriceFilter`).addEventListener("change",LoadProductsByPriceFilter);
//filter button to be removed
document.getElementById(`filterbtn`).addEventListener("click",LoadProductsByFilters)
document.getElementById('app').addEventListener("click", handleClicksofBtns);
document.querySelectorAll('[name="brand"]').forEach(chkbox => chkbox.addEventListener('change', LoadProductsByFilters));
document.querySelectorAll('[name="discount"]').forEach(chkbox => chkbox.addEventListener('change', LoadProductsByFilters));
document.querySelectorAll('[name="category"]').forEach(chkbox => chkbox.addEventListener('change', LoadProductsByFilters));
document.querySelectorAll('[name="rating"]').forEach(chkbox => chkbox.addEventListener('change', LoadProductsByFilters));
document.querySelectorAll('[name="size"]').forEach(chkbox => chkbox.addEventListener('change', LoadProductsByFilters));
//start
getShoesAsHtml(shoesData);

});